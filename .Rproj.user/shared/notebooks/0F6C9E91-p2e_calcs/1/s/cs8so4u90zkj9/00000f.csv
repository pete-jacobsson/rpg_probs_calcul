"0","p2e_twf_2d_dam_viz <- function(to_hit_mod_1,"
"0","                               to_hit_mod_2,"
"0","                               dam_mod,"
"0","                               ac,"
"0","                               die_max_1,"
"0","                               die_max_2,"
"0","                               dam_threshold) {"
"0","   "
"0","  title_text <- str_c(""To hit modifier (weapon 1): "", to_hit_mod_1,"
"0","                      ""; To hit modifier (weapon 2): "", to_hit_mod_2,"
"0","                      "";\nWepon die (weapon 1): d"", die_max_1,"
"0","                      ""; Wepon die (weapon 2): d"", die_max_2,"
"0","                      "";\nDamage modifier: "", dam_mod,"
"0","                      ""; AC: "", ac, ""."""
"0","                      )"
"0","  "
"0","  "
"0","  "
"0","  dam_df <- p2e_twf_2d_damcalc(to_hit_mod_1 = to_hit_mod_1,"
"0","                               to_hit_mod_2 = to_hit_mod_2,"
"0","                               dam_mod = dam_mod,"
"0","                               ac = ac,"
"0","                               die_max_1 = die_max_1,"
"0","                               die_max_2 = die_max_2)"
"0","  "
"0","  n_outcomes <- nrow(dam_df)"
"0","  "
"0","  dam_df <- dam_df |>"
"0","    group_by(dam_vector) |>"
"0","    summarize("
"0","      dam_probs = n() / n_outcomes"
"0","    )"
"0",""
"0","  "
"0","  ratio_over_threshold <- dam_df |>"
"0","    filter(dam_vector > dam_threshold) |>"
"0","    summarize("
"0","      dam_prob = sum(dam_probs)"
"0","    ) |>"
"0","    pull(dam_prob) |>"
"0","    round(2)"
"0","  "
"0","  caption_text <- str_c(""Probability of a hit greater than "", dam_threshold,"
"0","                        "" damage: "", ratio_over_threshold * 100, ""%"")"
"0","  "
"0","   dam_df |>"
"0","    ggplot(aes(x = dam_vector, y = dam_probs)) +"
"0","    geom_bar(stat = ""identity"", fill = ""steelblue"") +"
"0","    theme_classic() +"
"0","    labs("
"0","      x = ""Damage"","
"0","      y = ""Probability"","
"0","      title = title_text,"
"0","      subtitle = caption_text"
"0","    )"
"0","}"
