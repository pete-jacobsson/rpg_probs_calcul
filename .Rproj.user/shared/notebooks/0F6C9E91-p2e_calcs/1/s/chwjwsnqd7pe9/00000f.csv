"0","p2e_2d_damcalc <- function (to_hit_mod, dam_mod, ac, die_max){"
"0","  ### This function returns a vector of all possible damage outcomes for a P2E character doing two d6 damage die"
"0","  dam_vector <- c()"
"0","  "
"0","  for (d20 in 1:20) {"
"0","    to_hit <- d20 + to_hit_mod"
"0","    crit <- FALSE"
"0","    "
"0","    if (d20 == 20 | to_hit - ac >= 10) {crit <- TRUE}"
"0","    "
"0","    if ((to_hit - ac < 0 & !crit) | d20 == 1) {"
"0","      dam_vector <- c(dam_vector, rep(0, die_max ^ 2))  ### Need to balance against the number of outcomes for each hit"
"0","    } else {"
"0","      for (d1 in 1:die_max) {"
"0","        for (d2 in 1:die_max) {"
"0","          dam <- d1 + d2 + dam_mod"
"0","          if (crit) {dam <- dam * 2}"
"0","          dam_vector <- c(dam_vector, dam)"
"0","        }"
"0","      }"
"0","    }"
"0","    "
"0","  }"
"0","  "
"0","  dam_df <- data.frame(dam_vector)"
"0","  "
"0","  dam_df"
"0","}"
